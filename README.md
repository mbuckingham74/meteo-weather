<div align="center">

# Meteo Weather App

A comprehensive weather dashboard inspired by Weather Spark, providing detailed weather forecasts, historical climate data analysis, air quality monitoring, and AI-powered location comparison tools.

**ğŸŒ Live Demo:** [https://meteo-beta.tachyonfuture.com](https://meteo-beta.tachyonfuture.com)

**Built by:** [Michael Buckingham](https://github.com/mbuckingham74) &nbsp;&nbsp;|&nbsp;&nbsp; **Repository:** [meteo-weather](https://github.com/mbuckingham74/meteo-weather) &nbsp;&nbsp;|&nbsp;&nbsp; **Roadmap:** [View Features](ROADMAP.md) &nbsp;&nbsp;|&nbsp;&nbsp; **Changelog:** [View Updates](CHANGELOG.md)

---

[![Deployment Status](https://img.shields.io/github/actions/workflow/status/mbuckingham74/meteo-weather/deploy.yml?branch=main&label=deployment&logo=github-actions&logoColor=white)](https://github.com/mbuckingham74/meteo-weather/actions)
[![Security](https://img.shields.io/badge/vulnerabilities-0-brightgreen?logo=dependabot&logoColor=white)](https://github.com/mbuckingham74/meteo-weather/security)
[![Tests](https://img.shields.io/badge/tests-476%2F476%20passing-brightgreen?logo=jest&logoColor=white)](https://github.com/mbuckingham74/meteo-weather/actions)
[![Accessibility](https://img.shields.io/badge/WCAG%202.1-Level%20AA-blue?logo=w3c&logoColor=white)](#-accessibility-wcag-21-level-aa)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Docker](https://img.shields.io/badge/docker-ready-%230db7ed.svg?logo=docker&logoColor=white)](#-quick-start)
[![Live Demo](https://img.shields.io/badge/demo-live-success?logo=vercel&logoColor=white)](https://meteo-beta.tachyonfuture.com)

[![Code Coverage](https://img.shields.io/badge/coverage-33.65%25-yellow?logo=jest&logoColor=white)](#-setup-instructions)
[![Last Commit](https://img.shields.io/github/last-commit/mbuckingham74/meteo-weather?logo=git&logoColor=white)](https://github.com/mbuckingham74/meteo-weather/commits/main)
[![GitHub Stars](https://img.shields.io/github/stars/mbuckingham74/meteo-weather?style=social)](https://github.com/mbuckingham74/meteo-weather/stargazers)
[![GitHub Forks](https://img.shields.io/github/forks/mbuckingham74/meteo-weather?style=social)](https://github.com/mbuckingham74/meteo-weather/network/members)
[![Issues](https://img.shields.io/github/issues/mbuckingham74/meteo-weather?logo=github&logoColor=white)](https://github.com/mbuckingham74/meteo-weather/issues)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg?logo=github&logoColor=white)](CONTRIBUTING.md)

</div>

---

## ğŸ† Project Highlights

<div align="center">

| ğŸ¯ Feature | ğŸ“Š Metric | ğŸ’¡ Description |
|-----------|-----------|---------------|
| **Security Score** | 9.4/10 | Enterprise-grade security with 0 vulnerabilities |
| **Accessibility** | WCAG 2.1 AA | Full keyboard navigation, screen reader support |
| **Test Coverage** | 476/476 passing | Comprehensive test suite with zero failures |
| **API Efficiency** | 99% cache hit | MySQL-based caching, 282x faster responses |
| **Performance** | 20-50x faster | Optimized database queries with spatial indexes |
| **CI/CD Speed** | 50-70% faster | Aggressive caching with 9 parallel jobs |
| **Deployment** | Zero-downtime | Automated deployment with health checks |
| **Documentation** | 82 docs | Organized in 11 categories with OpenAPI spec |

**Key Achievements:**
- ğŸš€ Production-ready with [live demo](https://meteo-beta.tachyonfuture.com)
- ğŸ“š Complete API documentation in 3 formats (OpenAPI, Postman, Markdown)
- ğŸ—„ï¸ 585K+ pre-populated weather records across 148 cities
- ğŸ” Automated secret scanning with Gitleaks + Dependabot
- ğŸ“ˆ Advanced UI/UX with Material Design 3 (50-60% space reduction)
- ğŸ¤– AI-powered features with Claude Sonnet 4.5
- â™¿ Industry-leading accessibility (8.5-9/10 score)
- ğŸ”§ Admin panel for site owners with comprehensive system monitoring

</div>

---

## ğŸŒŸ Key Features

- **ğŸš€ Self-Hostable & Meteorological Nerd Approved** - Run your own weather station with professional-grade data
- **ğŸ›¡ï¸ Security-First Architecture** - Enterprise-grade security with automated secret scanning, Dependabot monitoring, and 0 vulnerabilities
- **â™¿ WCAG 2.1 Level AA Compliant** - Full accessibility with screen reader support, keyboard navigation, focus management, reduced motion, and contextual error suggestions (Score: 8.5-9/10)
- **âœ¨ Professional Error Handling** - Comprehensive error messaging with 200+ contextual suggestions, 4 display modes, offline detection, retry logic, and analytics tracking
- **ğŸ’« Ultra-Compact Dashboard** - Revolutionary two-column layout with everything in one viewport - weather info left, radar map right, zero scrolling needed
- **âš¡ Plug and Play** - Get started with a few free API keys in minutes
- **ğŸ’¾ Small Server Config Requirements** - Runs on minimal hardware ($6/month VPS)
- **ğŸ” Universal Smart Search** - ONE intelligent input handles simple locations AND complex AI queries
- **ğŸ¤– AI-First Interface** - Natural language weather questions powered by Claude Sonnet 4.5
- **ğŸ“Š Rich Data Visualization** - 15+ interactive charts for weather analysis
- **ğŸŒ§ï¸ Interactive Radar Map** - Real historical precipitation data with animation (respects reduced motion), alerts overlay, and storm tracking
- **âš ï¸ Weather Alerts** - Real-time severe weather warnings with map markers and keyboard-accessible expansion
- **ğŸ’¨ Air Quality Monitoring** - Live AQI data with health recommendations
- **ğŸ“ˆ 10-Year Climate Analysis** - Historical trends and statistical insights
- **ğŸ” User Accounts** - Cloud-synced favorites and preferences
- **âš™ï¸ User Preferences Page** - Comprehensive settings with email notification scheduling for daily/weekly weather reports
- **ğŸ“§ Email Notifications** - Scheduled weather reports, weather alerts, and weekly summaries (infrastructure ready)
- **ğŸ¨ Theme System** - Light, dark, and auto modes
- **ğŸŒ Location Comparison** - Compare weather across multiple cities with AI assistance
- **ğŸ“± Mobile Responsive** - Fully optimized for all device sizes
- **ğŸ”— Shareable URLs** - Direct links to any city's weather with browser back/forward support
- **âŒ¨ï¸ Complete Keyboard Navigation** - Full keyboard support with modal focus traps, logical tab order, and escape handlers
- **ğŸ“´ PWA Support** - Install as app, offline mode, and smart caching
- **ğŸ”§ Admin Panel** - Comprehensive dashboard for site owners with 6 tabs: system stats, user analytics, weather data insights, AI usage & cost tracking, cache management, and database monitoring

---

## ğŸ“¸ Screenshots

<div align="center">

### Main Dashboard
<!-- Add screenshot: Ultra-compact two-column layout with weather info and interactive radar -->
![Main Dashboard](docs/screenshots/dashboard.png)
*Ultra-compact dashboard with weather info and interactive radar map side-by-side*

### AI Weather Assistant
<!-- Add screenshot: AI Weather page showing natural language queries and visualizations -->
![AI Weather Assistant](docs/screenshots/ai-weather.png)
*Ask weather questions in natural language - powered by Claude Sonnet 4.5*

### Location Comparison
<!-- Add screenshot: Compare view showing multiple locations side-by-side -->
![Location Comparison](docs/screenshots/comparison.png)
*Compare weather across multiple cities with historical climate data*

### Interactive Radar Map
<!-- Add screenshot: Radar map with animation controls and weather alerts -->
![Interactive Radar](docs/screenshots/radar.png)
*Real-time precipitation radar with 2 hours of historical data and storm tracking*

### Weather Charts & Analytics
<!-- Add screenshot: Various weather charts (temperature, precipitation, wind, etc.) -->
![Weather Charts](docs/screenshots/charts.png)
*15+ interactive charts for detailed weather analysis*

### Dark Mode
<!-- Add screenshot: Dark mode interface showing theme consistency -->
![Dark Mode](docs/screenshots/dark-mode.png)
*Full dark mode support with complete theming across all components*

</div>

> **Note:** Screenshots are placeholders. Add actual screenshots to `docs/screenshots/` directory.

---

## âš¡ Quick Start

Get up and running in **3 minutes** with Docker:

```bash
# 1. Clone the repository
git clone https://github.com/mbuckingham74/meteo-weather.git
cd meteo-weather

# 2. Copy environment example and add your API keys
cp .env.example backend/.env
# Edit backend/.env - Add your FREE Visual Crossing API key

# 3. Start the application
docker-compose up

# 4. Open in browser
# Frontend: http://localhost:3000
# Backend API: http://localhost:5001
```

**That's it!** The app will start with pre-populated weather data for 148 cities.

**Get your FREE API keys (2 minutes):**
- **Visual Crossing** (required): [Sign up here](https://www.visualcrossing.com/weather-api) - 1000 records/day free
- **OpenWeather** (required for radar): [Sign up here](https://openweathermap.org/api) - 1000 calls/day free
- **Anthropic Claude** (optional, AI features): [Sign up here](https://console.anthropic.com/) - Pay-as-you-go (~$0.01/query)

**No API keys yet?** The app works out of the box with cached data for major cities!

---

## ğŸ’ Why Choose Meteo Weather App?

### For Users
- ğŸ¯ **AI-First Design** - Ask weather questions in natural language, not through menus
- ğŸš€ **Everything in One View** - Ultra-compact dashboard eliminates scrolling
- ğŸ¨ **Beautiful UI** - Material Design 3 with thoughtful spacing and professional aesthetics
- â™¿ **Accessible to All** - WCAG 2.1 AA compliant with screen reader support
- ğŸŒ— **Your Way** - Light/dark/auto themes, Celsius/Fahrenheit, customizable charts

### For Developers
- ğŸ“š **Learn from Production Code** - Real-world patterns for React, Node.js, and MySQL
- ğŸ—ï¸ **Modern Stack** - Vite, React Context, JWT auth, Docker, GitHub Actions
- ğŸ” **Security Best Practices** - 9.4/10 score with automated scanning and monitoring
- ğŸ“– **Comprehensive Docs** - 78 organized docs + OpenAPI spec + Postman collection
- ğŸ§ª **Well-Tested** - 476 passing tests with clear patterns to follow
- ğŸš€ **Easy Setup** - 3 minutes with Docker, works on $6/month VPS

### For Self-Hosters
- ğŸ’° **Free to Run** - $0/month with free API tiers (1,000 requests/day)
- ğŸ³ **Docker Ready** - One command to deploy with docker-compose
- ğŸ“‰ **Minimal Resources** - Runs on 2GB RAM, 1 CPU, 10GB storage
- ğŸ”’ **Your Data, Your Control** - No telemetry, no third-party tracking
- ğŸ“± **PWA Support** - Install as native app on any device

### For Contributors
- ğŸ¤ **Welcoming Community** - Clear contributing guidelines and code of conduct
- ğŸ¯ **Good First Issues** - Well-documented tasks for new contributors
- ğŸ“Š **Quality Standards** - Pre-commit hooks, CI/CD, and automated testing
- ğŸ† **Recognition** - Contributors credited in README and documentation

---

## ğŸ—ï¸ Built With

<div align="center">

### Frontend
![React](https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB)
![Vite](https://img.shields.io/badge/Vite-646CFF?style=for-the-badge&logo=vite&logoColor=white)
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black)
![CSS3](https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=css3&logoColor=white)
![Recharts](https://img.shields.io/badge/Recharts-FF6492?style=for-the-badge&logo=react&logoColor=white)
![Leaflet](https://img.shields.io/badge/Leaflet-199900?style=for-the-badge&logo=leaflet&logoColor=white)

### Backend
![Node.js](https://img.shields.io/badge/Node.js-43853D?style=for-the-badge&logo=node.js&logoColor=white)
![Express.js](https://img.shields.io/badge/Express.js-404D59?style=for-the-badge&logo=express&logoColor=white)
![MySQL](https://img.shields.io/badge/MySQL-00000F?style=for-the-badge&logo=mysql&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-000000?style=for-the-badge&logo=jsonwebtokens&logoColor=white)

### Infrastructure & APIs
![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)
![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-2088FF?style=for-the-badge&logo=github-actions&logoColor=white)
![Nginx](https://img.shields.io/badge/Nginx-009639?style=for-the-badge&logo=nginx&logoColor=white)
![Claude AI](https://img.shields.io/badge/Claude_AI-181818?style=for-the-badge&logo=anthropic&logoColor=white)

### External APIs
![Visual Crossing](https://img.shields.io/badge/Visual_Crossing-4285F4?style=for-the-badge&logo=weather&logoColor=white)
![OpenWeather](https://img.shields.io/badge/OpenWeather-EB6E4B?style=for-the-badge&logo=openweathermap&logoColor=white)
![RainViewer](https://img.shields.io/badge/RainViewer-0099CC?style=for-the-badge&logo=rain&logoColor=white)

</div>

---

## ğŸ“‹ Table of Contents

### Quick Navigation
- [âš¡ Quick Start](#-quick-start) - Get running in 3 minutes
- [ğŸŒ Live Demo](https://meteo-beta.tachyonfuture.com) - Try it now
- [âœ¨ Features](#-key-features) - What it does
- [ğŸ—ºï¸ **Product Roadmap**](ROADMAP.md) - **Planned features & timeline**
- [ğŸš€ Setup Guide](#-setup-instructions) - Detailed installation
- [ğŸ“š Full Documentation](docs/README.md) - **Complete docs hub**
- [ğŸ¤ Contributing](CONTRIBUTING.md) - Help improve this project
- [â“ FAQ & Support](SUPPORT.md) - Get help

### ğŸ“š Documentation Hub

**All documentation is organized in the [docs/](docs/) folder:**

| Category | Description | Link |
|----------|-------------|------|
| ğŸ“– **Getting Started** | Quick start, architecture, onboarding | [View â†’](docs/getting-started/) |
| ğŸ“¡ **API Reference** | Complete API docs (3 formats) | [View â†’](docs/api/) |
| ğŸš€ **Deployment** | Production deployment guides | [View â†’](docs/deployment/) |
| ğŸ” **Security** | Security features & audits | [View â†’](docs/security/) |
| â™¿ **Accessibility** | WCAG compliance documentation | [View â†’](docs/accessibility/) |
| âš™ï¸ **CI/CD** | Pipeline optimization & guides | [View â†’](docs/cicd/) |
| ğŸ’¾ **Database** | Schema, ERD, optimizations | [View â†’](docs/database/) |
| ğŸ¨ **UI/UX** | Design system & guidelines | [View â†’](docs/ui-ux/) |
| âš ï¸ **Troubleshooting** | Common issues & solutions | [View â†’](docs/troubleshooting/) |
| ğŸ’» **Development** | Code guides & conventions | [View â†’](docs/development/) |

**Most Popular Docs:**
- ğŸ¯ [3-Minute Quick Start](docs/getting-started/QUICKSTART.md)
- ğŸ“¡ [API Reference](docs/api/API_REFERENCE.md) (with OpenAPI & Postman)
- ğŸ—„ï¸ [Database Schema with ERD](docs/database/SCHEMA.md)
- ğŸ¥ [Video Tutorial Scripts](docs/getting-started/VIDEO_TUTORIAL_GUIDE.md)
- â“ [FAQ (50+ Questions)](SUPPORT.md)
- ğŸ” [Security Score: 9.4/10](docs/security/SECURITY_IMPLEMENTATION_SUMMARY.md)

### For Developers
- [ğŸ—ï¸ Architecture](docs/getting-started/ARCHITECTURE.md) - System design with diagrams
- [ğŸ“¡ OpenAPI Spec](docs/api/openapi.yaml) - Generate API clients
- [ğŸ“¦ Postman Collection](docs/api/postman_collection.json) - Test all endpoints
- [ğŸ—„ï¸ Database ERD](docs/database/SCHEMA.md) - Visual schema
- [ğŸ”§ Developer Setup](docs/getting-started/DEVELOPER_ONBOARDING.md) - Complete onboarding

---

## ğŸ’» Minimum Server Requirements

This application is lightweight and can run on minimal hardware. Perfect for personal VPS hosting or local development.

### Recommended Specifications
- **CPU:** 1-2 cores (2 GHz+)
- **RAM:** 2 GB minimum, 4 GB recommended
- **Storage:** 10 GB free space (includes Docker images, database, and logs)
- **Network:** Stable internet connection for external API calls
- **Operating System:** Linux (Ubuntu 20.04+), macOS, or Windows with WSL2

### Performance Notes
- **Development:** Runs smoothly on modern laptops with Docker Desktop
  - **macOS Users:** [OrbStack](https://orbstack.dev/) is highly recommended over Docker Desktop - faster, lighter, and more efficient
- **Production:** Successfully tested on DigitalOcean $6/month droplet (1 vCPU, 1 GB RAM)
- **Database Growth:** MySQL database grows slowly (~100-500 MB with aggressive caching)
- **Concurrent Users:** Handles 10-50 concurrent users comfortably on minimal specs
- **Docker Containers:** 3 containers (MySQL, Backend, Frontend) with modest resource usage

### What You Need Installed
- **Docker** (20.10+) and **Docker Compose** (1.29+)
- **Node.js** (14+) - only for local development without Docker
- **Git** - for cloning the repository

---

## ğŸ”‘ Required External APIs

This application requires API keys from the following services to function. Some are free, others have generous free tiers.

### 1. Visual Crossing Weather API (Required)
- **Purpose:** Primary weather data source - historical data (10+ years), current conditions, and forecasts
- **Sign Up:** [https://www.visualcrossing.com/weather-api](https://www.visualcrossing.com/weather-api)
- **Pricing:***
  - **Free Tier:** 1,000 records/day (sufficient for personal use)
  - **Paid Plans:** Starting at $0.0001 per record, monthly plans from $9/month
  - Timeline Weather API provides historical, current, and forecast data in a single endpoint
- **Environment Variable:** `VISUAL_CROSSING_API_KEY`

### 2. RainViewer API (Required for Radar)
- **Purpose:** Real-time precipitation radar data and historical radar frames (past 2 hours)
- **Sign Up:** Not required - **100% FREE**
- **Pricing:***
  - **Completely Free:** 1,000 requests/IP/minute
  - No API key needed, public API
  - Generous rate limits suitable for most applications
- **Limitations:** Free tier limited to zoom level 10
- **API Endpoint:** `https://api.rainviewer.com/public/weather-maps.json`

### 3. OpenWeather API (Required for Map Overlays)
- **Purpose:** Cloud cover and temperature tile overlays for the interactive map
- **Sign Up:** [https://openweathermap.org/api](https://openweathermap.org/api)
- **Pricing:***
  - **Free Tier:** 1,000 API calls/day, 60 calls/minute
  - **Paid Plans:** Starting at $0.0015 per call above free tier
  - Map tiles used: `clouds_new`, `temp_new`
- **Environment Variable:** `OPENWEATHER_API_KEY`

### 4. Anthropic Claude API (Optional - AI Features)
- **Purpose:** AI-powered location finder - natural language processing for climate search queries
- **Sign Up:** [https://console.anthropic.com/](https://console.anthropic.com/)
- **Pricing:***
  - **No Free Tier** - Pay-as-you-go pricing
  - **Claude Sonnet 4.5:** $3 per million input tokens, $15 per million output tokens
  - Typical query cost: ~$0.005-$0.010 per search (500-1000 tokens)
  - Budget: $99 = approximately 10,000-20,000 AI searches
- **Environment Variable:** `METEO_ANTHROPIC_API_KEY`
- **Note:** The app works fully without this API key - AI location finder will be disabled

**Important:** We use `METEO_ANTHROPIC_API_KEY` (not the standard `ANTHROPIC_API_KEY`) to avoid conflicts with Claude Code CLI during development.

### Cost Summary*

**Minimum to run the app (with free tiers):**
- Visual Crossing: **FREE** (up to 1,000 records/day)
- RainViewer: **FREE** (unlimited with rate limits)
- OpenWeather: **FREE** (up to 1,000 calls/day)
- **Total: $0/month** for personal/development use

**With AI features:**
- Add Anthropic Claude API: ~$5-20/month depending on usage
- The app implements aggressive caching (99% reduction in API calls) to minimize costs

***Pricing information accurate as of 10/31/2025**

---

## âœ¨ Features

### ğŸ” Universal Smart Search Bar + AI Weather Assistant

**A New Way to Check Weather** - The app features a revolutionary AI-first interface where natural language queries are the PRIMARY experience, not a hidden feature.

**Design Philosophy:**
Traditional weather apps make you search for cities, then click through menus to find answers. Meteo reverses this: describe what you want to know, and AI figures out the rest.

**How It Works:**
- Type **"Seattle"** â†’ Instant location change via geocoding (< 1 second, free)
- Type **"Will it rain this weekend in Seattle?"** â†’ Navigates to AI Weather page with auto-submit â†’ Instant answer
- Type **"I live in Florida June-November and it's miserable - where should I move?"** â†’ AI suggests alternatives with data
- Smart detection automatically routes queries based on complexity

**AI Weather Assistant Features:**
- **Auto-Submit** - Questions from Universal Search Bar submit automatically without requiring Enter twice
- **Smart Timeout Handling** - 30-second overall timeout with granular 10s validation + 20s analysis limits
- **Two-Step Validation** - Quick spam check (~$0.001) before full AI analysis (~$0.005)
- **Context-Aware Visualizations** - AI automatically detects query intent and displays fully interactive charts:
  - **Rain queries** ("Will it rain today?") â†’ Live RainViewer radar map + 25-year historical precipitation table with statistics
  - **Temperature queries** ("What's the temperature trend?") â†’ Color-coded temperature band chart with high/low ranges
  - **Wind queries** ("How windy will it be?") â†’ Wind speed and direction chart with compass indicators
  - **Forecast queries** ("What's the 48-hour forecast?") â†’ Interactive hourly chart with clickable metric views (temp, precip, wind)
  - All charts respect user's temperature unit preference (Â°C/Â°F)
- **Smart Follow-Up Questions** - After each answer, see 2-3 contextual follow-up questions that encourage exploration:
  - "Will it rain today?" â†’ "How does today compare to historical averages?", "What's the hourly rain forecast?"
  - Click any follow-up to instantly get a new AI answer with relevant visualizations
  - Zero API cost (generated server-side) with instant submission
- **Historical Precipitation Analysis** - When asking about rain "today", see 25 years of rainfall data for the current date with statistics (average, rainy day %, wettest year)
- **Confidence Indicators** - Shows High/Medium/Low confidence with answer
- **Token Transparency** - Displays exact token usage and cost per query
- **Error Recovery** - Clear, actionable error messages with timeout protection
- **Weather Context** - Displays current conditions and location with AI answer

**User Interface:**
- **Centered Hero Section** - Search bar is the FIRST thing you see, spanning full width
- **Conversational Placeholder** - Shows example complex query to inspire experimentation:
  - _"Ask me anything... e.g., 'Will it rain this weekend in Seattle?' or 'When did Denver experience its highest temperature?' or 'I live in Florida June-November and it's miserable - where should I move?'"_
- **Dynamic Quick Start Buttons** - Location-aware suggestions that change based on your current city:
  - ğŸŒ§ï¸ "Will it rain this weekend in **Seattle**?" (uses YOUR city)
  - ğŸ“Š "When did **Seattle** have its coldest December?"
  - ğŸï¸ "Find me somewhere warmer than **Seattle**"
- **ğŸ‘‡ Try asking:** label - Encourages exploration with emoji-coded examples

**Smart Detection:**
- **Triggers AI Mode:** Question words (what, when, where, how, should, will), comparative terms (similar, warmer, cooler, less humid), analytical phrases (climate like, better than, compared to)
- **Triggers Location Mode:** Simple city names, addresses, zip codes - anything that doesn't match AI patterns
- **Invisible Intelligence:** Users don't need to choose which mode - it just works

**Progressive Discovery:**
Users start with familiar location search, then discover AI capabilities through:
1. Seeing the conversational placeholder text
2. Clicking Quick Start buttons with their city's name
3. Experimenting with variations
4. Eventually crafting complex custom queries

**Why This Approach?**
- âœ… **Differentiation** - Most weather apps HIDE AI features in settings or make them feel experimental
- âœ… **AI-First** - Meteo makes natural language queries the DEFAULT, encouraging exploration
- âœ… **Discovery-Driven** - Users naturally learn through examples instead of reading docs
- âœ… **Cost-Effective** - Simple queries stay free, complex ones use AI only when needed (~$0.005-0.01)
- âœ… **Zero Learning Curve** - Works like normal search but unlocks AI superpowers

### ğŸŒ¤ï¸ Weather Forecasts

- **Multi-Day Forecasts** - 3, 7, or 14-day weather forecasts with dynamic time labels
- **48-Hour Interactive Chart** - Hourly forecasts with clickable metric views:
  - ğŸ“Š **Overview Mode** - Combined temperature, feels-like, and precipitation
  - ğŸ”¥ **High Temperature** - Focused view with area fill showing warmest hours
  - â„ï¸ **Low Temperature** - Detailed low temperature analysis
  - ğŸŒ§ï¸ **Precipitation** - Rainfall amounts with probability overlay
  - ğŸ’¨ **Wind Speed** - Wind analysis with average calculations
  - **Clickable Summary Cards** - Tap any stat to switch views instantly
- **Current Conditions Display** - Real-time temperature, feels-like, weather conditions, wind speed, humidity, visibility, and cloud cover
- **Temperature Unit Toggle** - Global Celsius/Fahrenheit toggle that syncs across all components
  - Persists to localStorage for guest users
  - Cloud-synced for authenticated users
  - Works consistently on all pages including location comparison
- **Weather Alerts** - Real-time severe weather warnings, watches, and advisories with color-coded severity levels
  - Expandable alert details with onset/end times
  - Automatic severity classification (warning, watch, advisory)
  - **Interactive map markers** showing alert locations with animated pulsing icons

### ğŸŒ§ï¸ Interactive Radar Map

**Real Historical Precipitation Data:**
- **Past 2 hours** of actual radar data (12-15 frames at 10-minute intervals)
- **30 minutes forecast** - Future precipitation predictions
- **RainViewer API integration** - Professional-grade radar data
- **5-minute caching** - Automatic updates every 10 minutes

**Layer Controls:**
- ğŸ’§ **Precipitation Overlay** - Real historical radar from RainViewer
- â˜ï¸ **Cloud Cover** - OpenWeather cloud layer
- ğŸŒ¡ï¸ **Temperature Overlay** - Temperature visualization
- âš ï¸ **Weather Alerts** - Animated markers for active warnings
- ğŸŒ€ **Storm Tracking** - Movement direction and speed analysis

**Animation Features:**
- â–¶ï¸/â¸ **Play/Pause** - Animate through radar history
- **Variable Speed** - 0.5x, 1x, 2x playback options
- ğŸ• **Time Selector** - Jump to any specific frame
- **Clickable Timeline** - Scrub through timestamps
- **Frame Counter** - Shows current position (e.g., "8 / 14")

**Advanced Capabilities:**
- **Precipitation Intensity Legend** - Color-coded scale (light â†’ moderate â†’ heavy)
- **Weather Alerts Overlay** - Pulsing markers with severity-based colors and detailed popups
- **Storm Tracking Panel** - Real-time movement direction (N, NE, E, etc.) and speed in km/h
- ğŸ“· **Screenshot Export** - Download current radar view as PNG
- ğŸ’¾ **Data Export** - Export frame metadata as JSON for analysis
- **Full dark mode support** - All controls adapt to theme

### ğŸ“Š Interactive Charts

#### Current Weather Charts
- **Temperature Bands** - Daily high/low/average temperature visualization
- **Feels-Like Temperature** - Compare actual temperature vs. feels-like temperature (wind chill/heat index)
- **Humidity & Dewpoint** - Dual-axis chart showing humidity percentage and dewpoint temperature
- **Sunrise & Sunset** - Visualize sunrise/sunset times with daylight duration calculations
- **Precipitation** - Daily rainfall and precipitation probability
- **Wind** - Wind speed and direction analysis
- **Cloud Cover** - Cloud coverage percentage over time
- **UV Index** - Daily UV exposure levels
- **Multi-Metric Overview** - Combined view of multiple weather metrics

#### Historical Climate Analysis
- **This Day in History** - Historical weather data for the current date over the past 10 years
- **Historical Comparison** - Compare current forecasts against 10-year climate normals
- **Record Temperatures** - Track record highs and lows for date ranges
- **Temperature Probability** - Statistical temperature distribution analysis

### ğŸ“ Location Management

- **Universal Smart Search** - ONE intelligent input for locations AND AI queries (see dedicated section above)
- **Geolocation Detection** - Automatic detection of current location via browser with intelligent fallback
  - Multi-tier fallback system (browser geolocation â†’ IP-based fallback)
  - Works even when reverse geocoding is rate-limited
  - Displays "Your Location" instead of raw coordinates for better UX
- **Favorites System** - Save and manage favorite locations with cloud sync (authentication required)
  - Access favorites from user profile modal
  - Automatic sync across all devices
- **Location Comparison** - Enhanced side-by-side weather comparison:
  - Compare 2-4 locations simultaneously
  - **Time Range Selector** - Choose 7 days, 1/3/6 months, or 1/3/5 years
  - **Pre-populated Examples** - Loads Seattle vs New Smyrna Beach comparison by default
  - **Weather Comparison Charts** - Temperature, precipitation, and wind visualizations
  - **Historical Climate Data** - 10-year averages for long-term comparisons
  - **Comparison Insights** - Automatic analysis showing warmest, coldest, wettest locations and temperature differences

### ğŸ”— URL Routing & Navigation

- **Shareable Location URLs** - Direct links to any city's weather
  - `/location/seattle-wa` - Seattle weather
  - `/location/new-york-ny-usa` - New York weather
  - Share links via text, email, or social media
- **Browser Navigation** - Full support for back/forward buttons
- **Deep Linking** - Load location directly from URL on page load
- **SEO-Friendly URLs** - Meaningful paths for better search indexing
- **Clickable Header** - "Meteo Weather" banner always links home (/)
- **Auto URL Sync** - URL updates automatically when you select a new location
- **Bookmarkable** - Save favorite city URLs in your browser

### ğŸ¤– AI-Powered Location Finder

- **Natural Language Climate Search** - Describe your ideal climate in plain English
  - Example: "I want somewhere 15 degrees cooler from June-October, less humid, not rainy"
  - Powered by **Claude Sonnet 4.5** for intelligent parsing
- **Smart Query Validation** - Three-layer validation system:
  - **Client-Side Sanitization (FREE)** - Instant validation blocks spam before API calls
  - **AI Quick Validation (~$0.001)** - Verifies query is climate-related
  - **AI Full Parsing (~$0.005)** - Extracts structured criteria
- **Structured Criteria Extraction** - AI automatically identifies:
  - Current location and time periods
  - Temperature preferences (delta or ranges)
  - Humidity and precipitation requirements
  - Lifestyle factors and deal-breakers
- **Cost Transparency** - Shows token usage and estimated cost per query
- **Spam Protection** - Client-side filtering blocks 20-30% of junk queries for FREE
  - Minimum/maximum length validation
  - Climate keyword detection (65+ terms)
  - Spam pattern blocking (repeated characters, "test", "lol", etc.)
  - Instant feedback with helpful error messages
- **Auto-Location Detection** - Automatically detects your current city on page load
- **Compact UI** - Clean prompt card with friendly "Can I just tell you what I want to compare..." button

### ğŸ’¨ Air Quality Index (AQI)

- **Real-Time AQI Data** - Current air quality index with color-coded severity levels
  - Good (0-50): Green
  - Moderate (51-100): Yellow
  - Unhealthy for Sensitive Groups (101-150): Orange
  - Unhealthy (151-200): Red
  - Very Unhealthy (201-300): Purple
  - Hazardous (301+): Maroon
- **Pollutant Breakdown** - Detailed measurements for:
  - PM2.5 (Fine particulate matter)
  - PM10 (Coarse particulate matter)
  - Oâ‚ƒ (Ozone)
  - NOâ‚‚ (Nitrogen dioxide)
  - CO (Carbon monoxide)
  - SOâ‚‚ (Sulphur dioxide)
- **Health Recommendations** - Context-aware advice based on current AQI levels
- **Both AQI Standards** - Support for US AQI and European AQI metrics
- **5-Day Forecast** - Hourly air quality predictions

### ğŸ‘¤ User Authentication & Profiles

- **User Registration** - Create account with email and password
- **Secure Login** - JWT-based authentication with token refresh
- **User Profiles** - Manage name, email, and password
- **Cloud Sync** - Favorites and preferences automatically sync across all devices
- **Auto-Migration** - localStorage favorites migrate to cloud on login
- **User Preferences** - Save default temperature units, forecast days, and theme
- **Profile Management** - Tab-based interface for profile, preferences, and security settings
- **Advanced Settings Page** - Comprehensive preferences management with:
  - Email notification scheduling (daily reports, weekly summaries, weather alerts)
  - Multiple report locations with location search
  - Configurable report time (user's local timezone)
  - Language and theme preferences
  - One-click access from dashboard for logged-in users

### ğŸ¨ Theme System

- **Simple Cycling Toggle** - Click to cycle through Light â†’ Dark â†’ Auto modes
- **Light Mode** - Clean, bright interface for daytime use
- **Dark Mode** - Easy on the eyes for low-light environments with comprehensive CSS variable system
- **Auto Mode** - Automatically follows system preferences
- **Smart Persistence** - Theme saved to cloud for logged-in users, localStorage for guests
- **Real-time Sync** - Theme preference syncs across all devices for authenticated users
- **Complete Dark Mode Coverage** - All components fully optimized for dark theme including:
  - All charts and visualizations
  - Location search and comparison views
  - Weather alerts and air quality cards
  - User profile and authentication modals
  - Consistent theming across all UI elements

### ğŸ”§ Admin Panel (Site Owners)

- **Comprehensive Dashboard** - 6-tab admin interface for system monitoring and management:
  - **ğŸ“Š Overview** - System health, most queried locations, top-level metrics
  - **ğŸ‘¥ Users** - Total users, active users (30 days), new signups (7 days), user engagement
  - **ğŸŒ¤ï¸ Weather Data** - Location statistics, weather records, most queried cities, data sources
  - **ğŸ¤– AI Usage** - Total AI queries, token usage, **estimated costs in USD**, confidence breakdown, popular shared answers
  - **ğŸ’¾ Cache** - Cache hit rate, valid/expired entries, one-click cleanup tools, performance metrics
  - **ğŸ—„ï¸ Database** - Total size, table statistics, largest tables, storage optimization
- **Access Control** - Database-based admin system (first user = auto-admin), JWT-protected routes
- **Privacy-First Design** - Admins can only see aggregated, anonymized data:
  - âœ… Total user counts, system metrics, aggregated statistics
  - âŒ Cannot view passwords, private AI conversations, individual user activity
- **AI Cost Tracking** - Real-time cost estimation for Claude Sonnet 4.5 usage:
  - Input tokens: $3 per million tokens
  - Output tokens: $15 per million tokens
  - Average query cost: ~$0.005-0.01
  - Budget monitoring and trend analysis
- **Cache Management** - One-click tools to optimize performance:
  - Clear expired cache entries (safe, frees space)
  - Clear all cache (emergency only, slower next requests)
  - Cache hit rate monitoring
  - Source-by-source breakdown
- **System Health Monitoring** - Real-time performance metrics:
  - Database size and growth trends
  - API usage statistics
  - Cache efficiency
  - User activity patterns
- **Security & Transparency** - Full documentation of admin capabilities:
  - Privacy policy updated with admin data disclosures
  - Security audit documentation (9.4/10 score)
  - Clear separation between admin access and user privacy
- **Route:** `http://localhost:3000/admin` (requires authentication + admin status)
- **Documentation:** 4 comprehensive guides (2,100+ lines) in `docs/admin/`

### ğŸ›¡ï¸ Error Handling & Connectivity

- **ErrorMessage Component** - Unified error display system with 4 modes:
  - **Inline** - Field-level errors for forms (polite ARIA live region)
  - **Toast** - Dismissible notifications with auto-hide (top-right corner)
  - **Banner** - Persistent warnings across top of page (connectivity issues)
  - **Modal** - Critical errors requiring acknowledgment (center overlay)
- **Offline Detection** - OfflineBanner component with automatic online/offline status monitoring
- **Slow Connection Warnings** - Optional detection of degraded network performance
- **Retry Logic** - useRetryHandler hook with exponential backoff (1s â†’ 2s â†’ 4s)
- **Error Analytics** - useErrorAnalytics hook tracks error patterns, frequency, and resolution
- **Accessibility First** - WCAG 2.1 AA compliant with proper ARIA roles and labels
- **Timeout Configuration** - Environment-aware timeout settings (VITE_WEATHER_TIMEOUT, etc.)
- **Toast Container** - Stacked error notifications with z-index management
- **Full Dark Mode Support** - Error UI adapts to theme automatically

### âš™ï¸ Customization

- **Chart Visibility Controls** - Show/hide individual charts
- **Quick Toggle** - Show all or hide all charts with one click
- **User Preferences** - Persistent settings for logged-in users
- **Responsive Design** - Mobile-friendly interface

---

## â™¿ Accessibility (WCAG 2.1 Level AA)

**Accessibility Score: 8.5-9/10** - Full WCAG 2.1 Level AA compliance + one AAA criterion

Meteo Weather App is built with accessibility as a core priority, ensuring everyone can access weather information regardless of ability or assistive technology used.

### âœ… WCAG 2.1 Standards Compliance

**Level A (Foundation)**
- âœ… **1.1.1** Non-text Content - All images and icons have alt text or aria-hidden
- âœ… **1.3.1** Info & Relationships - Proper semantic HTML, form labels, heading hierarchy
- âœ… **2.1.1** Keyboard - All functionality accessible via keyboard
- âœ… **2.4.1** Bypass Blocks - Skip to content links
- âœ… **2.4.3** Focus Order - Logical tab navigation with modal focus traps

**Level AA (Target)**
- âœ… **1.4.3** Contrast (Minimum) - 4.5:1 color contrast ratio maintained throughout
- âœ… **2.4.7** Focus Visible - Visible focus indicators (3px purple outline)
- âœ… **3.3.1** Error Identification - Clear error messages
- âœ… **3.3.3** Error Suggestion - Actionable recovery suggestions (200+ contextual hints)
- âœ… **4.1.3** Status Messages - Live region announcements for dynamic content

**Level AAA (Bonus)**
- âœ… **2.3.3** Animation from Interactions - Reduced motion support via `prefers-reduced-motion`

### ğŸ¯ Accessibility Features

**Screen Reader Support**
- Live region announcements for weather data loading/errors
- Proper ARIA labels on all interactive elements
- Descriptive button labels (e.g., "Play radar animation" not just "Play")
- Hidden text for decorative icons
- Status announcements for async operations

**Keyboard Navigation**
- Complete keyboard access to all features
- Modal focus traps (Tab/Shift+Tab wrapping)
- Escape key to close modals
- Logical tab order across all pages
- Focus restoration when modals close
- Arrow key support for interactive elements

**Motion & Animation**
- Automatic detection of `prefers-reduced-motion` setting
- Radar animation auto-pauses for users with motion sensitivity
- All transitions/animations respect user preferences
- Visual indicator when animations are disabled
- Fallback `.reduced-motion` class

**Enhanced Error Handling**
- 200+ contextual error suggestions
- Browser-specific instructions (Chrome, Firefox, Safari, Edge)
- Priority suggestions for quick fixes
- Contextual help text for complex errors
- Multiple display modes (inline, toast, banner, modal)

**Form Accessibility**
- All inputs have proper labels (visible or sr-only)
- Error messages announced to screen readers
- Clear validation feedback
- Helpful placeholder text
- Focus management in forms

**Color & Contrast**
- All text meets 4.5:1 contrast minimum
- Color not used as sole indicator
- High contrast focus indicators
- Theme support (light/dark/auto)

**Mobile Accessibility**
- Touch targets 44Ã—44px minimum
- Responsive layouts for screen readers
- Zoom support up to 200%
- No horizontal scrolling

### ğŸ“‹ Testing & Validation

**Automated Testing**
- axe DevTools (Chrome/Firefox)
- Lighthouse Accessibility Audit
- WAVE WebAIM Evaluation
- ESLint accessibility plugin

**Manual Testing**
- NVDA (Windows) - Full compatibility
- JAWS (Windows) - Full compatibility
- VoiceOver (macOS/iOS) - Full compatibility
- Keyboard-only navigation - Complete
- Color contrast analyzer - Verified

**Regression Prevention**
- Pre-commit accessibility checks
- Automated regression test suite
- Custom ESLint rules
- Comprehensive documentation

### ğŸ“š Accessibility Documentation

For detailed implementation information, see:
- **[Accessibility Audit Summary](docs/accessibility/AUDIT_SUMMARY.md)** - Quick reference guide
- **[Accessibility Phase 1 Complete](docs/accessibility/PHASE1_COMPLETE.md)** - Phase 1 (WCAG Level A) implementation
- Phase 2 (WCAG Level AA) implementation details included in commit history

### ğŸ“ Learn More

- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [WebAIM Resources](https://webaim.org/)

---

## ğŸ¤– Development & Automation

Professional development workflow with automated testing, security scanning, and community management tools.

### GitHub Actions CI/CD

**Automated Deployment** (`deploy.yml`):
- ğŸš€ Automatic deployment to production on every push to `main`
- ğŸ” Secure SSH key authentication
- âœ… Runs deployment script on server (`scripts/deploy-beta.sh`)
- ğŸ” Post-deployment health checks (frontend + API)
- ğŸ“Š Deployment summary with commit info
- âš¡ Zero-downtime deployments
- ğŸ¯ Manual trigger option via GitHub Actions UI
- **Required Secret:** `SSH_PRIVATE_KEY` (see `.github/SECRETS_SETUP.md`)

**Automated Testing** (`ci.yml`):
- âœ… Multi-version testing (Node 20.x LTS)
- âœ… Backend linting and unit tests
- âœ… Frontend testing with Jest and React Testing Library
- âœ… Production build validation with ESLint checks
- âœ… Docker image build verification
- âœ… Docker Compose configuration validation
- âš¡ Runs on every push and pull request

**Security Scanning** (`codeql.yml`):
- ğŸ”’ Automated CodeQL analysis
- ğŸ” JavaScript vulnerability detection
- ğŸ“… Weekly scheduled scans (Mondays)
- ğŸš¨ Security alerts for dependencies
- ğŸ“Š GitHub Security tab integration

**Container Publishing** (`docker-publish.yml`):
- ğŸ“¦ Automated Docker image building
- ğŸ·ï¸ Semantic versioning tags (latest, sha-<commit>, releases)
- ğŸ“¤ GitHub Container Registry publishing (ghcr.io)
- ğŸ”„ Build caching for faster deployments
- ğŸ¯ Triggered on push to main, releases, and manual dispatch

**Setup Guide:**
- See `.github/SECRETS_SETUP.md` for configuring GitHub Secrets
- See `.github/WORKFLOWS.md` for complete workflow documentation

### Community Health Files

**Contributing Guidelines** (`CONTRIBUTING.md`):
- ğŸ“– Comprehensive contribution guide
- ğŸ’» Development setup instructions
- ğŸ¨ Code style guidelines
- ğŸ”„ Pull request process
- ğŸ¯ High-priority contribution areas
- ğŸ† Contributor recognition

**Code of Conduct** (`CODE_OF_CONDUCT.md`):
- ğŸ¤ Contributor Covenant v2.0
- ğŸ›¡ï¸ Community standards
- ğŸ“‹ Enforcement guidelines
- ğŸ“§ Reporting process

**Security Policy** (`SECURITY.md`):
- ğŸ” Vulnerability reporting process
- ğŸ›¡ï¸ Security best practices
- âœ… Production deployment checklist
- ğŸ”’ API key management guidelines
- ğŸ³ Docker security recommendations

### Issue & PR Templates

**Structured Issue Templates**:
- ğŸ› Bug Report (detailed form with component selection)
- âœ¨ Feature Request (with priority levels)
- â“ Question Template (for support)
- âš™ï¸ Configuration (helpful links to docs, discussions, demo)

**Pull Request Template**:
- âœ… Comprehensive checklist (code quality, testing, docs)
- ğŸ·ï¸ Type classification (bug fix, feature, refactor, etc.)
- ğŸ§ª Testing requirements
- ğŸ“š Documentation requirements
- ğŸ”’ Security considerations

### Repository Features

**Topics & Discoverability**:
- ğŸ·ï¸ 20 curated topics for maximum visibility
- ğŸ” SEO-optimized description
- ğŸŒ Live demo link
- ğŸ“Š Comprehensive badges (tech stack, GitHub stats)

**Documentation**:
- ğŸ“ Detailed README with setup instructions
- ğŸ¯ GITHUB_TOPICS.md (discovery strategy)
- ğŸ“£ PROMOTION.md (launch content for multiple platforms)
- ğŸ—ºï¸ .claude/INSTRUCTIONS.md (AI-assisted development guidelines)
- ğŸ“˜ docs/development/AGENTS.md (Repository guidelines for new contributors and agents)

### Roadmap Ideas

**Testing Enhancements**:
- [ ] Increase test coverage to 80%+
- [ ] Add E2E testing with Playwright/Cypress
- [ ] Implement visual regression testing
- [ ] Add performance testing benchmarks
- [ ] API integration tests

**Automation Improvements**:
- [ ] Automated dependency updates (Dependabot/Renovate)
- [ ] Automated changelog generation
- [ ] Release automation with semantic-release
- [ ] Automated Docker image scanning (Trivy)
- [ ] PR size labeling and auto-assignment
- [ ] Stale issue/PR management
- [ ] Auto-labeling based on file changes
- [ ] Automated code quality reports (SonarCloud)

**Developer Experience**:
- [ ] Dev container configuration (VSCode)
- [ ] GitHub Codespaces support
- [ ] Hot reload for backend development
- [ ] Pre-commit hooks (Husky)
- [ ] Commit message linting (Commitlint)
- [ ] API documentation generation (Swagger/OpenAPI)
- [ ] Database migration system
- [ ] Seed data for development

**Monitoring & Observability**:
- [ ] Application performance monitoring (APM)
- [ ] Error tracking (Sentry)
- [ ] Uptime monitoring
- [ ] Database query performance tracking
- [ ] API rate limit monitoring
- [ ] User analytics (privacy-focused)

**Deployment Enhancements**:
- [ ] Multi-stage Docker builds optimization
- [ ] Kubernetes deployment manifests
- [ ] Terraform infrastructure as code
- [ ] Blue-green deployment strategy
- [ ] Automatic rollback on failures
- [ ] Environment-specific configurations
- [ ] Secrets management (Vault/Sealed Secrets)

---

## ğŸ› ï¸ Tech Stack

### Frontend
- **React** - UI framework with Context API for state management
  - AuthContext - User authentication state
  - ThemeContext - Light/dark/auto theme management
  - LocationContext - Global location selection state
  - TemperatureUnitContext - Celsius/Fahrenheit preference
- **Recharts** - Data visualization library
- **Leaflet** - Interactive mapping library for radar visualization
- **React-Leaflet** - React components for Leaflet maps
- **html2canvas** - Screenshot capture for radar exports
- **CSS3** - Custom styling with CSS variables for theming and gradient designs
- **localStorage** - Client-side preferences and theme storage (with cloud sync for authenticated users)
- **Custom Utilities** (Nov 2025):
  - `debugLogger` - Environment-aware logging system
  - `errorHandler` - Standardized error management with 20+ error codes
  - `useLocationConfirmation` - Reusable location confirmation hook
  - `constants/` - Centralized configuration and helper functions

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework
- **MySQL** - Database for user data, preferences, and API response caching
- **bcryptjs** - Secure password hashing
- **jsonwebtoken (JWT)** - Token-based authentication
- **Docker** - Containerized development environment
- **Intelligent API Caching** - MySQL-based cache layer reducing API calls by 99%
- **@anthropic-ai/sdk** - Claude AI integration for natural language processing

### External APIs
- **Anthropic Claude API** - Natural language processing for climate preference parsing (Claude Sonnet 4.5)
- **RainViewer API** - Real-time precipitation radar data (past 2 hours + 30 min forecast)
- **Visual Crossing Weather API** - Weather data, forecasts, historical climate data, and weather alerts
- **OpenWeather API** - Cloud cover and temperature overlay tiles
- **Open-Meteo Air Quality API** - Real-time and forecast air quality data (PM2.5, PM10, Oâ‚ƒ, NOâ‚‚, CO, SOâ‚‚)
- **Browser Geolocation API** - Current location detection

---

## ğŸš€ Setup Instructions

### Prerequisites
- Docker and Docker Compose installed
- Visual Crossing Weather API key ([get free tier](https://www.visualcrossing.com/weather-api))

### Installation

#### 1. Clone the repository
```bash
git clone https://github.com/mbuckingham74/meteo-app.git
cd meteo-app
```

#### 2. Configure environment variables

Create `backend/.env`:
```env
# Weather API
VISUAL_CROSSING_API_KEY=your_api_key_here

# AI-Powered Location Finder (optional)
METEO_ANTHROPIC_API_KEY=your_anthropic_api_key_here

# Database
DB_HOST=db
DB_USER=weather_user
DB_PASSWORD=secure_password
DB_NAME=weather_db

# Server
PORT=5001

# Authentication
JWT_SECRET=your_secret_key_here_change_in_production
JWT_REFRESH_SECRET=your_refresh_secret_key_here_change_in_production
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d
```

**Note:** AI-powered location finder requires an [Anthropic API key](https://console.anthropic.com/). The feature is optional and the app works without it. We use `METEO_ANTHROPIC_API_KEY` (not the standard `ANTHROPIC_API_KEY`) to avoid conflicts with Claude Code CLI when developing this application.

#### 3. Start the application
```bash
docker-compose up --build
```

#### 4. Access the application
- **Frontend**: http://localhost:3000
- **Backend API**: http://localhost:5001

---

## ğŸ”’ Security: A Top Priority

**Security Score: 9.4/10** - This project implements enterprise-grade security practices to protect your data and API keys.

### ğŸ›¡ï¸ Multi-Layer Security Protection

This repository is protected by multiple automated security systems:

#### 1. **Gitleaks Secret Scanning** âœ…
**Already Configured!** Prevents accidental commits of API keys, passwords, and tokens.

- âœ… **Pre-commit hook** - Blocks commits with secrets before they enter git history
- âœ… **GitHub Actions CI/CD** - Scans every push and pull request automatically
- âœ… **Weekly scheduled scans** - Runs every Sunday at 2 AM UTC to detect historical leaks
- âœ… **Custom detection rules** - Project-specific patterns for OpenWeather, Visual Crossing, Anthropic API keys, JWT secrets, and database passwords
- âœ… **SARIF report uploads** - Integrates with GitHub Security tab for centralized monitoring

#### 2. **Dependabot Automated Monitoring** âœ…
**Automatic vulnerability detection and patching.**

- âœ… **Vulnerability alerts** - Real-time notifications for security issues in dependencies
- âœ… **Automated security PRs** - Dependabot creates pull requests to fix vulnerabilities automatically
- âœ… **Weekly dependency updates** - Checks for updates every Monday at 9:00 AM
- âœ… **Multi-ecosystem support** - Monitors npm (frontend & backend), GitHub Actions, and Docker images
- âœ… **Zero current vulnerabilities** - All 9 vulnerabilities (6 high, 3 moderate) have been patched

#### 3. **npm Security Audits** âœ…
**Regular dependency vulnerability scanning.**

- âœ… **Current status:** 0 vulnerabilities in 1,416 frontend packages
- âœ… **Backend status:** 0 vulnerabilities
- âœ… **Automated fixes:** npm overrides force secure dependency versions
- âœ… **Fixed CVEs:**
  - CVE-2021-3803 (nth-check) - ReDoS vulnerability - **HIGH**
  - CVE-2023-44270 (postcss) - Line return parsing error - **MODERATE**
  - Multiple webpack-dev-server vulnerabilities - **MODERATE**

### ğŸ“‹ Security in Action

**Example: Gitleaks Pre-Commit Protection**
```bash
# When you try to commit a file with secrets:
git add .env  # (hypothetically)
git commit -m "Add config"

# Output:
ğŸ” Running Gitleaks security scan...
âŒ COMMIT BLOCKED: Gitleaks detected potential secrets!

ğŸ“‹ What to do:
  1. Review the findings above
  2. Remove any real secrets from your staged changes
  3. Move secrets to .env files (which are gitignored)
  4. If this is a false positive, add it to .gitleaks.toml allowlist
```

**Manual Security Scans:**
```bash
# Scan entire git history for secrets
gitleaks detect --verbose

# Scan only staged changes (pre-commit)
gitleaks protect --staged

# Check for npm vulnerabilities
npm audit

# Check Dependabot alerts
gh api repos/mbuckingham74/meteo-weather/dependabot/alerts
```

### ğŸ”§ Installation & Setup

**Gitleaks (for local development):**
```bash
# macOS
brew install gitleaks

# Linux
curl -sSfL https://github.com/gitleaks/gitleaks/releases/download/v8.28.0/gitleaks_8.28.0_linux_x64.tar.gz \
  | tar -xz -C /usr/local/bin gitleaks

# The pre-commit hook is already configured in .git/hooks/pre-commit
# It will activate automatically after cloning this repository
```

**Dependabot Configuration:**
- Already enabled in this repository via `.github/dependabot.yml`
- Monitors frontend npm, backend npm, GitHub Actions, and Docker
- Creates automated PRs every Monday at 9:00 AM
- No additional setup required for contributors

### ğŸš¨ Emergency: Secret Exposed

If you accidentally commit a secret to git:

1. **Rotate the exposed credential immediately** (delete old key, generate new one)
2. **DO NOT** just delete the file - git history retains it
3. Use `git log -- path/to/file` to find the exposing commit
4. Consider using `git filter-branch` or BFG Repo-Cleaner for history rewriting
5. Force push carefully: `git push --force` (coordinate with team first)
6. Update the new secret in `.env` files (never commit these)

**Better Solution:** Prevention is easier than cleanup. Let Gitleaks block it before it enters git!

### ğŸ”‘ API Key Management

**Best Practices:**

1. **Never commit `.env` files** - Already gitignored âœ…
2. **Use `.env.example` for documentation** - Placeholder values only âœ…
3. **Rotate exposed keys immediately** - Check git history for leaks
4. **Use environment-specific files**:
   - `.env` - Local development
   - `.env.production` - Production server (gitignored)
   - `.env.secrets` - Documentation of all keys (gitignored)

5. **Restrict API key domains** (when possible):
   - OpenWeather: Add domain restrictions in dashboard
   - Anthropic: Monitor usage for anomalies
   - Visual Crossing: Set usage alerts

### ğŸ” Secrets Checklist

Before pushing to GitHub, verify:

- [ ] All `.env` files are in `.gitignore`
- [ ] No API keys hardcoded in source code
- [ ] Example files use placeholder values only
- [ ] Gitleaks pre-commit hook is active
- [ ] Production secrets are stored securely on server
- [ ] Database passwords are strong and unique
- [ ] JWT secrets are at least 32 characters

### ğŸ“Š Security Monitoring & Maintenance

**Automated Weekly Tasks:**
- âœ… **Sunday 2 AM UTC** - Gitleaks full repository scan (GitHub Actions)
- âœ… **Monday 9 AM UTC** - Dependabot dependency update checks
- âœ… **Every Push** - Gitleaks scan + npm audit + tests
- âœ… **Every PR** - Security scan before merge

**Manual Monthly Review (5 minutes):**
1. Check GitHub Security tab: https://github.com/mbuckingham74/meteo-weather/security
2. Review Dependabot PRs and merge security updates
3. Verify npm audit reports: `npm audit` in frontend/ and backend/
4. Scan production deployment with Mozilla Observatory
5. Check API usage alerts (OpenWeather, Visual Crossing, Anthropic)

**Quarterly Security Audit (30 minutes):**
- [ ] Run SecurityHeaders.com scan on production
- [ ] Review and update security headers (see [`docs/SECURITY_HEADERS.md`](docs/SECURITY_HEADERS.md))
- [ ] Rotate API keys (best practice: annual rotation)
- [ ] Update npm dependencies: `npm update` + test thoroughly
- [ ] Review git history for any missed secret exposures
- [ ] Verify all `.env` files are properly gitignored

### ğŸŒ Infrastructure Security

**Branch Protection (GitHub Rulesets):**
Main branch is protected with GitHub repository rulesets.

**Protections Enabled:**
- âœ… Prevents accidental branch deletion
- âœ… Repository admin bypass enabled (maintains workflow flexibility)
- âœ… Targets main branch only (feature branches remain unrestricted)
- âœ… Works seamlessly with pre-commit hooks and CI/CD

**What This Means:**
- Direct pushes to main still work (admin bypass)
- Force pushes allowed for emergency fixes
- Prevents accidental `git branch -D main`
- No pull request requirement for solo development

**HTTP Security Headers:**
Comprehensive security headers guide available in [`docs/SECURITY_HEADERS.md`](docs/SECURITY_HEADERS.md)

**Includes:**
- Content Security Policy (CSP) to prevent XSS attacks
- X-Frame-Options to prevent clickjacking
- X-Content-Type-Options to prevent MIME sniffing
- Strict Transport Security (HSTS) for HTTPS enforcement
- Permissions-Policy for browser feature control
- Step-by-step Nginx configuration guide
- Testing and validation procedures

**Implementation Status:**
- âœ… Documentation complete
- âš ï¸ Awaiting production deployment

**Expected Security Scores After Implementation:**
- Mozilla Observatory: **A+**
- SecurityHeaders.com: **A**
- SSL Labs: **A+**

---

## ğŸŒ API Endpoints

### Weather Forecasts

#### Get Multi-Day Forecast
```
GET /api/weather/forecast/:location?days=7
```
- **Parameters**: `days` (3, 7, or 14)
- **Returns**: Daily weather forecast with temperature, precipitation, wind, etc.

#### Get Hourly Forecast
```
GET /api/weather/hourly/:location?hours=48
```
- **Parameters**: `hours` (up to 240)
- **Returns**: Hourly weather data

---

### Historical Climate Data

#### Get Climate Normals
```
GET /api/weather/climate/normals/:location?date=MM-DD&years=10
```
- **Parameters**: `date` (MM-DD format), `years` (default: 10)
- **Returns**: Historical averages and percentiles

#### Get Record Temperatures
```
GET /api/weather/climate/records/:location?start=MM-DD&end=MM-DD&years=10
```
- **Parameters**: `start` date, `end` date, `years`
- **Returns**: Record high/low temperatures for date range

#### Compare Forecast to Historical
```
POST /api/weather/climate/compare/:location
```
- **Body**: `{ forecastData: [...] }`
- **Returns**: Comparison with historical climate normals

#### Get This Day in History
```
GET /api/weather/climate/this-day/:location?date=MM-DD&years=10
```
- **Parameters**: `date` (optional), `years`
- **Returns**: Historical data for specific date

#### Get Temperature Probability
```
GET /api/weather/climate/probability/:location?start=MM-DD&end=MM-DD&years=10
```
- **Parameters**: `start` date, `end` date, `years`
- **Returns**: Temperature distribution statistics

---

### Location Services

#### Search Locations
```
GET /api/locations/geocode?q=London&limit=5
```
- **Parameters**: `q` (query), `limit` (max results)
- **Returns**: List of matching locations

#### Reverse Geocode
```
GET /api/locations/reverse?lat=51.5074&lon=-0.1278
```
- **Parameters**: `lat` (latitude), `lon` (longitude)
- **Returns**: Location details for coordinates

#### Get Popular Locations
```
GET /api/locations/popular
```
- **Returns**: List of popular cities worldwide

---

### Authentication & User Management

#### Register User
```
POST /api/auth/register
```
- **Body**: `{ email, password, name }`
- **Returns**: User object with JWT tokens

#### Login User
```
POST /api/auth/login
```
- **Body**: `{ email, password }`
- **Returns**: User object with JWT tokens

#### Get Current User
```
GET /api/auth/me
```
- **Headers**: `Authorization: Bearer <token>`
- **Returns**: Current user profile

#### Update Profile
```
PUT /api/auth/profile
```
- **Headers**: `Authorization: Bearer <token>`
- **Body**: `{ name, email }`
- **Returns**: Updated user object

#### Change Password
```
POST /api/auth/change-password
```
- **Headers**: `Authorization: Bearer <token>`
- **Body**: `{ currentPassword, newPassword }`
- **Returns**: Success message

---

### User Preferences & Favorites

#### Get User Preferences
```
GET /api/user/preferences
```
- **Headers**: `Authorization: Bearer <token>`
- **Returns**: User preferences object

#### Update Preferences
```
PUT /api/user/preferences
```
- **Headers**: `Authorization: Bearer <token>`
- **Body**: `{ temperature_unit, default_forecast_days, theme }`
- **Returns**: Updated preferences

#### Get Cloud Favorites
```
GET /api/user/favorites
```
- **Headers**: `Authorization: Bearer <token>`
- **Returns**: Array of favorite locations

#### Add Favorite
```
POST /api/user/favorites
```
- **Headers**: `Authorization: Bearer <token>`
- **Body**: `{ location_name, latitude, longitude, address, timezone }`
- **Returns**: Created favorite object

#### Remove Favorite
```
DELETE /api/user/favorites/:id
```
- **Headers**: `Authorization: Bearer <token>`
- **Returns**: Success message

#### Import Favorites
```
POST /api/user/favorites/import
```
- **Headers**: `Authorization: Bearer <token>`
- **Body**: `{ favorites: [...] }`
- **Returns**: Import results with count

---

### AI-Powered Location Finder

#### Validate Query
```
POST /api/ai-location-finder/validate-query
```
- **Body**: `{ userInput: "I want somewhere warmer" }`
- **Returns**: `{ success: true, isValid: true, reason: "...", tokensUsed: 275 }`
- **Cost**: ~$0.001 per query (~200-300 tokens)
- **Purpose**: Quick validation to prevent spam before expensive parsing

#### Parse Location Query
```
POST /api/ai-location-finder/parse-query
```
- **Body**:
  ```json
  {
    "userInput": "I want somewhere 15 degrees cooler from June-October, less humid",
    "currentLocation": {
      "lat": 29.0258,
      "lng": -80.9270,
      "city": "New Smyrna Beach, FL"
    }
  }
  ```
- **Returns**:
  ```json
  {
    "success": true,
    "criteria": {
      "current_location": "New Smyrna Beach, FL",
      "time_period": { "start": "June", "end": "October" },
      "temperature_delta": -15,
      "humidity": "lower",
      "precipitation": "less",
      "lifestyle_factors": [],
      "deal_breakers": []
    },
    "tokensUsed": 572,
    "cost": "$0.0051"
  }
  ```
- **Cost**: ~$0.005 per query (~500-1000 tokens)
- **Purpose**: Extract structured climate preferences from natural language

**Client-Side Validation** (FREE):
- Runs in browser before API calls
- Blocks spam, short text, non-climate queries
- Saves 20-30% of API costs
- Implemented in `frontend/src/utils/inputSanitizer.js`

---

### AI Weather Analysis

#### Validate Weather Query
```
POST /api/ai-weather/validate
```
- **Body**: `{ query: "Will it rain today?", location: "Seattle, WA" }`
- **Returns**: `{ isValid: true/false, reason: "...", tokensUsed: 275 }`
- **Cost**: ~$0.001 per query (~200-300 tokens)
- **Purpose**: Quick validation to ensure query is weather-related before expensive analysis
- **Timeout**: 10 seconds with AbortController

#### Analyze Weather Question
```
POST /api/ai-weather/analyze
```
- **Body**: `{ query: "Will it rain this weekend?", location: "Seattle, WA", days: 7 }`
- **Returns**:
  ```json
  {
    "answer": "Based on the forecast...",
    "confidence": "high",
    "tokensUsed": 825,
    "weatherData": {
      "location": "Seattle, WA",
      "currentConditions": "Partly cloudy",
      "temperature": 18.5
    }
  }
  ```
- **Cost**: ~$0.005-0.01 per query (~500-1000 tokens)
- **Purpose**: Full AI analysis of weather question with context from Visual Crossing API
- **Model**: Claude Sonnet 4.5
- **Timeout**: 20 seconds with AbortController
- **Overall Timeout**: 30 seconds for complete request

**Features:**
- Two-step validation prevents spam and abuse
- AbortController for proper timeout handling
- Weather data fetched from Visual Crossing API before AI analysis
- Confidence scoring (high/medium/low)
- Token usage tracking for cost transparency
- Comprehensive error messages

---

### Air Quality

#### Get Air Quality Data
```
GET /api/air-quality?lat=37.7749&lon=-122.4194&days=5
```
- **Parameters**: `lat` (latitude), `lon` (longitude), `days` (forecast days, max 5)
- **Returns**: Current and forecast air quality data with:
  - US AQI and European AQI values
  - AQI level classification with colors
  - All pollutant measurements (PM2.5, PM10, Oâ‚ƒ, NOâ‚‚, CO, SOâ‚‚)
  - Health recommendations
  - Hourly forecast data
  - Summary statistics

#### Get Air Quality by Location Name
```
GET /api/air-quality/location/:location?lat=37.7749&lon=-122.4194&days=5
```
- **Parameters**: `location` (location name), `lat`, `lon`, `days`
- **Returns**: Air quality data with location context

---

## ğŸ“ Project Structure

```
meteo-app/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ charts/              # Weather visualization charts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TemperatureBandChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FeelsLikeChart.jsx           # NEW: Feels-like vs actual temp
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HumidityDewpointChart.jsx    # NEW: Humidity & dewpoint
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SunChart.jsx                 # NEW: Sunrise/sunset visualization
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PrecipitationChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WindChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CloudCoverChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UVIndexChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WeatherOverviewChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HourlyForecastChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HistoricalComparisonChart.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RecordTemperaturesChart.jsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TemperatureProbabilityChart.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ cards/               # Weather data cards
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ThisDayInHistoryCard.jsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AirQualityCard.jsx           # NEW: AQI display
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/                # Authentication components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthHeader.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthModal.jsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ UserProfileModal.jsx         # Includes favorites tab
â”‚   â”‚   â”‚   â”œâ”€â”€ theme/               # Theme components
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ThemeToggle.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ units/               # NEW: Unit preference components
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TemperatureUnitToggle.jsx    # NEW: C/F toggle
â”‚   â”‚   â”‚   â”œâ”€â”€ ai/                  # AI-powered features
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UniversalSearchBar.jsx       # Smart search (locations + AI)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UniversalSearchBar.css       # Styling for universal search
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AIWeatherPage.jsx            # Full-page AI weather assistant with auto-submit
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ AIWeatherPage.css            # AI page styling
â”‚   â”‚   â”‚   â”œâ”€â”€ location/            # Location management
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FavoritesPanel.jsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LocationComparisonView.jsx
â”‚   â”‚   â”‚   â””â”€â”€ weather/             # Main dashboard
â”‚   â”‚   â”‚       â”œâ”€â”€ WeatherDashboard.jsx
â”‚   â”‚   â”‚       â”œâ”€â”€ RadarMap.jsx                 # NEW: Interactive radar with real historical data
â”‚   â”‚   â”‚       â”œâ”€â”€ RadarMap.css                 # Radar map styling
â”‚   â”‚   â”‚       â””â”€â”€ WeatherAlertsBanner.jsx      # Weather alerts display
â”‚   â”‚   â”œâ”€â”€ contexts/                # React Context providers
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.js
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeContext.js
â”‚   â”‚   â”‚   â”œâ”€â”€ LocationContext.js               # NEW: Global location state
â”‚   â”‚   â”‚   â””â”€â”€ TemperatureUnitContext.js        # NEW: C/F preference
â”‚   â”‚   â”œâ”€â”€ styles/                  # Global styles
â”‚   â”‚   â”‚   â””â”€â”€ themes.css
â”‚   â”‚   â”œâ”€â”€ hooks/                   # Custom React hooks
â”‚   â”‚   â”‚   â”œâ”€â”€ useWeatherData.js
â”‚   â”‚   â”‚   â””â”€â”€ useClimateData.js
â”‚   â”‚   â”œâ”€â”€ services/                # API and local services
â”‚   â”‚   â”‚   â”œâ”€â”€ weatherApi.js
â”‚   â”‚   â”‚   â”œâ”€â”€ radarService.js              # NEW: RainViewer API integration
â”‚   â”‚   â”‚   â”œâ”€â”€ locationFinderService.js     # NEW: AI location finder API client
â”‚   â”‚   â”‚   â”œâ”€â”€ authApi.js
â”‚   â”‚   â”‚   â”œâ”€â”€ favoritesService.js
â”‚   â”‚   â”‚   â””â”€â”€ geolocationService.js
â”‚   â”‚   â””â”€â”€ utils/                   # Helper functions
â”‚   â”‚       â”œâ”€â”€ weatherHelpers.js
â”‚   â”‚       â”œâ”€â”€ urlHelpers.js                # NEW: URL routing and slug generation
â”‚   â”‚       â”œâ”€â”€ inputSanitizer.js            # NEW: Client-side query validation
â”‚   â”‚       â””â”€â”€ inputSanitizer.test.js       # NEW: Validation tests
â”‚   â””â”€â”€ public/
â”‚
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ weather.js               # Weather API endpoints
â”‚   â”‚   â”œâ”€â”€ airQuality.js            # Air quality API endpoints
â”‚   â”‚   â”œâ”€â”€ aiLocationFinder.js      # AI-powered location finder endpoints
â”‚   â”‚   â”œâ”€â”€ aiWeatherAnalysis.js     # AI weather question analysis endpoints
â”‚   â”‚   â”œâ”€â”€ locations.js             # Location API endpoints
â”‚   â”‚   â”œâ”€â”€ auth.js                  # Authentication endpoints
â”‚   â”‚   â””â”€â”€ user.js                  # User preferences & favorites
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ weatherService.js        # Weather data fetching (includes alerts)
â”‚   â”‚   â”œâ”€â”€ airQualityService.js     # Air quality data from Open-Meteo
â”‚   â”‚   â”œâ”€â”€ aiLocationFinderService.js # Claude AI integration for NLP (climate search)
â”‚   â”‚   â”œâ”€â”€ aiWeatherAnalysisService.js # Claude AI for weather Q&A with timeout handling
â”‚   â”‚   â”œâ”€â”€ climateService.js        # Historical climate analysis
â”‚   â”‚   â”œâ”€â”€ geocodingService.js      # Location search
â”‚   â”‚   â”œâ”€â”€ authService.js           # Authentication logic
â”‚   â”‚   â”œâ”€â”€ userPreferencesService.js # User preferences management
â”‚   â”‚   â””â”€â”€ userFavoritesService.js  # Cloud favorites management
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ authMiddleware.js        # JWT authentication middleware
â”‚   â””â”€â”€ server.js
â”‚
â””â”€â”€ docker-compose.yml
```

---

## ğŸ“– Usage

### Main Dashboard

1. **Search for a location** using the search bar in the controls panel
2. **Use your current location** via the "Use My Location" button
3. **Adjust settings**:
   - Toggle temperature units (Â°C/Â°F) in the dashboard controls
   - Select forecast duration (3, 7, or 14 days) in the controls panel
4. **View current conditions** - See real-time temperature, weather, wind, humidity, and more
5. **Explore the interactive radar map**:
   - Press play to animate through past 2 hours of precipitation
   - Toggle different layers (precipitation, clouds, temperature)
   - View weather alert markers if active
   - Enable storm tracking to see movement analysis
   - Download screenshots or export data
6. **Customize chart visibility** using the chart controls panel
7. **Save favorite locations** (requires login) - Access from user profile modal

### Location Comparison

1. Click **"Compare Locations"** from the main dashboard (loads with Seattle vs New Smyrna Beach pre-populated)
2. **Choose a time range** (7 days, 1/3/6 months, or 1/3/5 years) to analyze different periods
3. **Try the example questions** - Click any example to instantly load relevant locations and time ranges:
   - "Which city gets more rain annually?"
   - "Where is winter milder?"
   - "Which location has a milder summer?"
4. **Search and select your own locations** (2-4 locations) for custom comparisons
5. View **side-by-side weather data** with detailed charts:
   - Temperature band charts showing daily highs/lows
   - Precipitation totals and patterns
   - Wind speed comparisons
   - Historical climate comparisons (for longer time ranges)
6. See **automatic insights** showing which location is warmest, coldest, wettest, and temperature differences

### Favorites Management

1. **Login or create an account** (favorites require authentication)
2. **Search for and select a location** on the main dashboard
3. **Open your user profile** by clicking your profile icon in the header
4. **Navigate to the Favorites tab** in the profile modal
5. **Add the current location to favorites** from within the favorites tab
6. **Click any favorite** to quickly load that location's weather data
7. **Remove favorites** by clicking the trash icon next to any saved location

Note: Favorites automatically sync across all your devices when you're logged in.

---

## ğŸ” Features in Detail

### Historical Climate Analysis

The app analyzes **10 years of historical weather data** to provide:

- **Climate Normals** - 30-day rolling averages with percentile bands (10th-90th)
- **Record Tracking** - Historical record high and low temperatures
- **Statistical Analysis** - Mean, median, standard deviation for temperature distributions
- **Forecast Context** - Compare current forecasts against historical norms to understand if weather is typical

### Smart Location Search

- **Autocomplete** - Real-time suggestions as you type
- **Debounced Search** - Optimized to reduce API calls (300ms delay)
- **Keyboard Navigation** - Use arrow keys and Enter to navigate results
- **Popular Locations** - Quick access to major cities when search is empty
- **Geolocation** - Automatically detect and reverse geocode your current position

### Data Visualization

All charts are built with **Recharts** and feature:
- Responsive design
- Interactive tooltips
- Custom color schemes
- Gradient fills and area charts
- Dual Y-axes for multi-metric charts
- Summary statistics

---

## ğŸš€ Performance & Caching

### Intelligent API Caching

The application implements a **MySQL-based caching layer** that dramatically reduces API calls and improves response times:

**Cache Performance:**
- âš¡ **99% reduction** in API requests for repeat queries
- ğŸï¸ **282x faster** responses (from 850ms to 3ms)
- ğŸ’¾ Automatic cleanup of expired entries every hour

**Cache TTL (Time To Live):**
- Current Weather: 30 minutes (optimized from 15 min)
- Forecasts: 6 hours (optimized from 2 hours)
- Historical Data: 7 days (optimized from 24 hours)
- Air Quality: 60 minutes (optimized from 30 min)
- Climate Stats: 30 days (optimized from 7 days)

**Cache Management Endpoints:**
- `GET /api/cache/stats` - View cache statistics
- `DELETE /api/cache/expired` - Clear expired entries
- `DELETE /api/cache/location/:id` - Clear location-specific cache

**Benefits:**
- Reduced API costs (stay within free tier limits)
- Faster page loads for cached data
- Better user experience with instant responses
- Automatic expiration ensures fresh data

### Request Throttling & Rate Limit Protection

The application includes intelligent request management to prevent API rate limiting:

**Throttling Features:**
- ğŸš¦ **Max 3 concurrent requests** - Prevents API stampeding
- â±ï¸ **100ms minimum interval** - Spaces out requests to avoid rate limits
- ğŸ”„ **Exponential backoff retry** - Automatically retries failed requests with increasing delays
- ğŸ›¡ï¸ **Graceful fallbacks** - Continues to work even when API limits are hit
  - Geolocation uses coordinates if reverse geocoding fails
  - Cached data served when fresh requests are blocked

**How it Works:**
- Requests queue automatically when limits are reached
- Retry logic: Initial request â†’ Wait 1s â†’ Retry â†’ Wait 2s â†’ Final retry
- Prevents cascade failures across multiple components
- User experience maintained even during high API usage

## âš ï¸ API Rate Limiting

The Visual Crossing API has rate limits on the free tier:
- **1,000 records per day**
- Historical climate features make multiple API calls (10+ for 10-year analysis)
- **With caching enabled**, most requests are served from cache, dramatically reducing API usage
- Consider the API costs when enabling multiple historical charts

---

## ğŸ¤ Contributing

This is a learning project inspired by Weather Spark. Contributions and suggestions are welcome!

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ğŸ“„ License

MIT License - feel free to use this project for learning and development.

---

## ğŸ™ Data Attribution

- Radar data provided by **[RainViewer API](https://www.rainviewer.com/)**
- Weather data and alerts provided by **[Visual Crossing Weather API](https://www.visualcrossing.com/)**
- Radar overlay tiles by **[OpenWeather API](https://openweathermap.org/)**
- Air quality data provided by **[Open-Meteo Air Quality API](https://open-meteo.com/)**
- Visualizations inspired by **[Weather Spark](https://weatherspark.com/)**

---

## ğŸ—ºï¸ Project Status & Roadmap

### âœ… Completed Features

**Core Weather Functionality**
- [x] Multi-day forecasts (3, 7, 14 days) with Visual Crossing API
- [x] 48-hour detailed hourly forecasts
- [x] Interactive weather charts (temperature, precipitation, wind, UV, cloud cover)
- [x] Real-time weather alerts and severe weather warnings
- [x] Air quality index (AQI) with pollutant breakdown
- [x] Enhanced visualizations (humidity/dewpoint, sunrise/sunset, feels-like temps)

**Historical Climate Analysis**
- [x] 10-year historical climate data analysis
- [x] "This Day in History" feature
- [x] Historical comparison charts (forecast vs. climate normals)
- [x] Record temperature tracking
- [x] Temperature probability distributions

**User Experience**
- [x] User authentication system (JWT-based)
- [x] Cloud-synced favorites across devices
- [x] Light/dark/auto theme system with cloud persistence
- [x] User profiles with customizable preferences
- [x] Location search with autocomplete and geolocation
- [x] Location comparison tool (2-4 locations side-by-side)
- [x] Responsive mobile design
- [x] Chart visibility controls
- [x] **URL routing with shareable links** (e.g., `/location/seattle-wa`)
- [x] **Progressive Web App (PWA)** - Install, offline support, smart caching
- [x] **Error Boundary** - Graceful error handling with retry options
- [x] **Loading Skeletons** - Content-aware loading states
- [x] **Keyboard Navigation** - Full accessibility (/, Esc, Ctrl+K shortcuts)
- [x] **ARIA labels** - Screen reader support (WCAG 2.1 AA compliant)

**Performance & Infrastructure**
- [x] MySQL-based API response caching (99% reduction in API calls)
- [x] Automatic cache expiration and cleanup
- [x] Cache monitoring and management endpoints
- [x] Request throttling and exponential backoff retry
- [x] Graceful API rate limit handling

**Recent Enhancements (November 2025)**
- [x] **Ultra-Compact Dashboard Layout** - Revolutionary two-column design (Nov 5, 2025)
  - Everything fits in one viewport without scrolling (~40% vertical space reduction)
  - Two-column grid: weather info left (1fr), radar map right (600Ã—600px)
  - Reduced font sizes: location 48pxâ†’32px, temperature 96pxâ†’72px, condition 24pxâ†’20px
  - Simplified stats: 5 columnsâ†’3 columns (Wind, Humidity, 24h Precip)
  - All padding reduced by 35-40%, borders 2pxâ†’1px
  - Shorter button labels ("Compare Locations"â†’"Compare")
  - Removed chart preview button and temperature toggle label
  - Radar map prominence increased from 450Ã—500px to 600Ã—600px (~45% of viewport width)
  - **Files:** WeatherDashboard.css, WeatherDashboard.jsx, RadarMap.css
  - **Commits:** 6064610, 22c7d2a, 05021f7, a63c0b6
- [x] **RadarMap Height Bug Fix** - Fixed prop type mismatch (Nov 5, 2025)
  - Component expected numeric height but received string "350px"
  - Result: Invalid CSS "350pxpx" prevented proper rendering
  - Fixed both instances in CurrentConditionsSection.jsx and WeatherDashboard.jsx
  - Removed conflicting min-height and height: 100% from RadarMap.css
  - Now renders correctly at specified height across all browsers
- [x] **Professional Error Handling System** - Complete overhaul (Nov 5, 2025)
  - ErrorMessage component with 4 display modes (inline, toast, banner, modal)
  - OfflineBanner for connectivity monitoring with slow connection detection
  - Error analytics system with tracking and statistics
  - useOnlineStatus and useRetryHandler hooks with exponential backoff
  - Environment-aware timeout configuration (VITE_* variables)
  - 700+ lines of error message style guide
  - RadarMap updated to use new error system
  - **15 files total** (9 new, 6 modified), 3,130+ lines of code
  - **Status:** All 4 phases complete (100%)
- [x] **AI Weather Assistant** - Full conversational weather Q&A interface
  - Auto-submit from Universal Search Bar (no double-Enter required)
  - Smart timeout handling (30s overall, 10s validation, 20s analysis)
  - Two-step validation system with cost transparency
  - Confidence indicators and token usage display
  - Comprehensive error recovery with actionable messages
  - Circular dependency prevention in React hooks
  - Environment-aware API URLs for production deployment
  - AbortController for proper fetch cancellation

**Recent Enhancements (October 2025)**
- [x] **Interactive radar map with real historical precipitation data** (RainViewer API)
  - Real past 2 hours + 30 min forecast data
  - Time selector for frame navigation
  - Storm tracking with movement direction and speed
  - Screenshot and data export capabilities
  - Weather alerts overlay with animated markers
  - Precipitation intensity legend
- [x] **Enhanced location comparison page**
  - Time range selector (7 days to 5 years)
  - Pre-populated with Seattle vs New Smyrna Beach example
  - Interactive "How to Use" guide with clickable questions
  - Historical climate data integration for long-term comparisons
  - Weather comparison charts (temperature, precipitation, wind)
  - Automatic insights and statistics
- [x] **Interactive hourly forecast chart**
  - Clickable metric views (Overview, High, Low, Precipitation, Wind)
  - Focused visualizations for each metric
  - Interactive summary cards with state management
- [x] Comprehensive dark mode CSS refactor using variable system
- [x] Global temperature unit sync across all components
- [x] Simplified theme toggle (cycling button: Light â†’ Dark â†’ Auto)
- [x] Improved "Use My Location" to display "Your Location" instead of coordinates
- [x] Fixed radar map height in flex layouts (min-height issue resolved)
- [x] **Radar map layout optimization** - Moved to full-width position (~1376px vs ~878px, 58% wider on desktop)
- [x] Improved theme consistency across all UI elements
- [x] Better error handling and fallback mechanisms
- [x] Temperature unit toggle moved to dashboard controls for better UX
- [x] **Dashboard UX improvements (Latest)**
  - Section headers for clear delineation ("Current Conditions" and "Forecast & Charts")
  - Prominent "View [CityName] Forecast & Charts" button with gradient styling
  - Personalized button text showing current city name
  - Removed confusing "Forecast Days" dropdown (standardized to 7 days)
  - Enhanced chart visibility with bold labels and axis information
  - Increased font sizes for titles, axis labels, and legends
  - Better chart readability with explicit color values
  - 5 compact stat boxes including new 24-hour precipitation total
  - City name prominence increased (36-42px, extra bold weight)
  - Equal padding and spacing in location header
  - Improved coordinates/timezone readability (monospace font, better contrast)
- [x] **Accessibility & Quality Improvements (Oct 2025)**
  - Fixed ARIA accessibility warnings (added `aria-selected` to dropdown options)
  - Test coverage increased from 31.48% to 33.65%
  - Added comprehensive color scales utility tests (100% coverage)
  - Fixed LocationSearchBar test failure
  - All 476 tests passing with zero failures
- [x] **Deployment Infrastructure**
  - Fixed backend auto-restart issue in deployment script
  - Backend now rebuilds and restarts automatically on code changes
  - Added `--force-recreate` flag to ensure container recreation
  - Prevents stale code running in production

### ğŸš§ Planned Enhancements

**Data & Features**
- [ ] Push notifications for severe weather alerts
- [ ] Extended historical data (20+ years of climate analysis)
- [ ] Seasonal climate summaries and trends
- [ ] Animated GIF export for radar loops
- [ ] Advanced storm cell tracking with NEXRAD data
- [ ] Marine and aviation weather data
- [ ] Pollen and allergen forecasts
- [ ] Lightning strike data integration
- [ ] Satellite imagery overlay

**User Experience**
- [ ] Mobile app (iOS/Android with React Native)
- [ ] Data export capabilities (CSV, PDF reports)
- [ ] Customizable dashboard layouts (drag-and-drop widgets)
- [ ] Multi-language support (i18n)
- [ ] Accessibility improvements (WCAG compliance)

**Performance & Technical**
- [ ] Redis caching layer (upgrade from MySQL cache)
- [ ] Offline mode with local data storage
- [ ] Progressive Web App (PWA) capabilities
- [ ] GraphQL API option
- [ ] Webhook support for automated weather updates
- [ ] CDN integration for static assets

---

## ğŸ‘¨â€ğŸ’» Author

**Michael Buckingham**
- GitHub: [@mbuckingham74](https://github.com/mbuckingham74)
- Project: [meteo-weather](https://github.com/mbuckingham74/meteo-weather)

---

**Built with â¤ï¸ using React, Node.js, and the Visual Crossing Weather API**
