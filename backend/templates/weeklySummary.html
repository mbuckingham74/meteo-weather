<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Weather Summary</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: #f5f7fa;
      color: #1a202c;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background-color: #ffffff;
    }
    .header {
      background: linear-gradient(135deg, #5b21b6 0%, #7c3aed 100%);
      padding: 32px 24px;
      text-align: center;
      color: #ffffff;
    }
    .header h1 {
      margin: 0 0 8px 0;
      font-size: 28px;
      font-weight: 600;
    }
    .header p {
      margin: 0;
      font-size: 16px;
      opacity: 0.9;
    }
    .greeting {
      padding: 24px;
      font-size: 16px;
      line-height: 1.6;
      color: #2d3748;
    }
    .location-section {
      padding: 0 24px 24px 24px;
    }
    .location-card {
      background-color: #faf5ff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
      border: 1px solid #e9d5ff;
    }
    .location-name {
      font-size: 20px;
      font-weight: 600;
      color: #2d3748;
      margin: 0 0 20px 0;
      text-align: center;
    }
    .forecast-table {
      width: 100%;
      border-collapse: collapse;
    }
    .forecast-row {
      border-bottom: 1px solid #e9d5ff;
    }
    .forecast-row:last-child {
      border-bottom: none;
    }
    .forecast-cell {
      padding: 16px 8px;
      text-align: left;
    }
    .forecast-cell.center {
      text-align: center;
    }
    .forecast-cell.right {
      text-align: right;
    }
    .day-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .day-name {
      font-size: 16px;
      font-weight: 600;
      color: #2d3748;
      min-width: 80px;
    }
    .day-date {
      font-size: 14px;
      color: #718096;
    }
    .weather-icon {
      font-size: 32px;
    }
    .temp-range {
      font-size: 16px;
      white-space: nowrap;
    }
    .temp-high {
      font-weight: 600;
      color: #dc2626;
    }
    .temp-low {
      font-weight: 600;
      color: #2563eb;
      margin-left: 8px;
    }
    .conditions-cell {
      max-width: 150px;
    }
    .conditions-text {
      font-size: 14px;
      color: #4a5568;
      line-height: 1.4;
    }
    .precip-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      background-color: #dbeafe;
      color: #1e40af;
    }
    .precip-high {
      background-color: #fee2e2;
      color: #991b1b;
    }
    .summary-box {
      background-color: #f0f9ff;
      border-left: 4px solid #7c3aed;
      padding: 16px;
      margin: 24px;
      border-radius: 4px;
    }
    .summary-title {
      font-size: 14px;
      font-weight: 600;
      color: #5b21b6;
      margin: 0 0 8px 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .summary-text {
      font-size: 14px;
      color: #475569;
      line-height: 1.6;
      margin: 0;
    }
    .footer {
      background-color: #faf5ff;
      padding: 24px;
      text-align: center;
      border-top: 1px solid #e9d5ff;
    }
    .footer-links {
      margin-bottom: 16px;
    }
    .footer-link {
      color: #7c3aed;
      text-decoration: none;
      font-size: 14px;
      margin: 0 12px;
    }
    .footer-text {
      font-size: 12px;
      color: #718096;
      margin: 8px 0;
    }
    .button {
      display: inline-block;
      background-color: #7c3aed;
      color: #ffffff;
      padding: 12px 24px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      margin: 16px 0;
    }
    @media only screen and (max-width: 600px) {
      .day-name {
        font-size: 14px;
        min-width: 60px;
      }
      .day-date {
        font-size: 12px;
      }
      .weather-icon {
        font-size: 24px;
      }
      .temp-range {
        font-size: 14px;
      }
      .conditions-text {
        font-size: 12px;
      }
      .forecast-cell {
        padding: 12px 4px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>ðŸ“… Weekly Weather Summary</h1>
      <p>Week of {{WEEK_OF}}</p>
    </div>

    <!-- Greeting -->
    <div class="greeting">
      <p>Hello, {{USER_NAME}}! ðŸ‘‹</p>
      <p>Here's your weekly weather outlook for the locations you're tracking.</p>
    </div>

    <!-- Summary Insight -->
    <div class="summary-box">
      <p class="summary-title">ðŸ“Š Week at a Glance</p>
      <p class="summary-text">
        Planning your week? Check the detailed forecast below for temperature trends,
        precipitation chances, and conditions across all your saved locations.
      </p>
    </div>

    <!-- Location Forecast Cards -->
    <div class="location-section">
      {{#each LOCATIONS}}
      <div class="location-card">
        <h2 class="location-name">{{location_name}}</h2>

        <table class="forecast-table">
          <tbody>
            {{#each forecast}}
            <tr class="forecast-row">
              <!-- Day and Date -->
              <td class="forecast-cell">
                <div class="day-info">
                  <div>
                    <div class="day-name">{{day}}</div>
                    <div class="day-date">{{date}}</div>
                  </div>
                </div>
              </td>

              <!-- Weather Icon -->
              <td class="forecast-cell center">
                <div class="weather-icon">{{icon}}</div>
              </td>

              <!-- Temperature Range -->
              <td class="forecast-cell center">
                <div class="temp-range">
                  <span class="temp-high">{{high}}Â°{{../unit}}</span>
                  <span class="temp-low">{{low}}Â°{{../unit}}</span>
                </div>
              </td>

              <!-- Conditions -->
              <td class="forecast-cell conditions-cell">
                <div class="conditions-text">{{conditions}}</div>
              </td>

              <!-- Precipitation -->
              <td class="forecast-cell right">
                {{#if precip}}
                <span class="precip-badge {{#if (gt precip 50)}}precip-high{{/if}}">
                  ðŸ’§ {{precip}}%
                </span>
                {{else}}
                <span class="precip-badge">ðŸ’§ 0%</span>
                {{/if}}
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>
      {{/each}}
    </div>

    <!-- Call to Action -->
    <div style="text-align: center; padding: 0 24px 24px 24px;">
      <a href="https://meteo-beta.tachyonfuture.com/dashboard" class="button">View Detailed Forecast</a>
    </div>

    <!-- Footer -->
    <div class="footer">
      <div class="footer-links">
        <a href="{{PREFERENCES_URL}}" class="footer-link">Manage Preferences</a>
        <a href="{{UNSUBSCRIBE_URL}}" class="footer-link">Unsubscribe</a>
      </div>
      <p class="footer-text">You're receiving this because you enabled weekly weather summaries.</p>
      <p class="footer-text">Â© 2025 Meteo Weather. All rights reserved.</p>
    </div>
  </div>
</body>
</html>
